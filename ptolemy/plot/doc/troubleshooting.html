<!-- $Id$-->
<html>
<head>
<title>Troubleshooting Ptplot</title>
</head>
<body bgcolor="#faf0e6">
<h1><a name="ptplot troubleshooting ">Troubleshooting Ptplot</a></h1>
<p>
Other sources of information:
<MENU>
<LI> <A HREF="ptplotfaq.html">Ptplot Frequently Asked Questions (FAQ)</A>
<LI> <A HREF="codeDoc/ptplot.Pxgraph.html#Installation Instructions">Pxgraph Installation Instructions</A>
</MENU>

Below is a list of common Ptplot problems.


<H2><A NAME="Problems Starting Ptplot">Problems Starting Ptplot</A></H2>

<H3><A NAME="CLASSPATH">CLASSPATH</A></H3>
CLASSPATH is by far and above the trickiest thing to get right.
 <P>One known problem is that if you have a
CLASSPATH environment set when you started your browser, you may get
an error message when accessing some of the demos.
We suggest unsetting this environment variable, restarting your
browser (and sending email to Sun's Java team to complain about the
way the CLASSPATH environment variable works).
You may also want to check the
<A HREF="http://sunsite.unc.edu/javafaq/javafaq.html">Java FAQ</A>.

If you have CLASSPATH set, and you run netscape, then you might see
messages like:
<PRE>
Applet Marks can't start: security violation: security.class
from local disk trying to access url:
http://ptolemy.eecs.berkeley.edu/java/ptolemy/plot/demo/data.plt
</PRE>

<H3><CODE>pxgraph</CODE> script fails with: Unable to initialize threads: cannot find class</H3>
Below is an example:
<PRE>
ptplot&gt; ./pxgraph
Unable to initialize threads: cannot find class
java/lang/Thread
</PRE>
The problem here is that the java interpreter is not finding
<CODE>lib/classes.zip</CODE> in the Java Development Kit distribution.
 <P>One fix is to edit the <CODE>pxgraph</CODE> script
and change <CODE>JAVADEFAULT</CODE> variable to point to the location
of your JDK.
HOME <P>Another fix is to set the <CODE>JAVAHOME</CODE> variable
to point to your JDK and rerun pxgraph:
<PRE>
cxh@carson 41% setenv JAVAHOME /opt/jdk1.1.6
cxh@carson 42% pxgraph -help
Usage: pxgraph [ options ] [=WxH+X+Y] [file ...]
 options that take values as second args:
</PRE>
For further debugging, you might find it helpful to follow the instructions below.
 <HR>
<H3><CODE>pxgraph</CODE> script fails with: Can't find class ptolemy.plot.Pxgraph</H3>
Here is an example
<PRE>
carson [3] pxgraph -help
Can't find class ptolemy.plot.Pxgraph
carson [4]
</PRE>

The problem here is that the pxgraph script cannot find the ptplot
installation.
 <P>The solution here is to use <CODE>which</CODE> to find out which pxgraph
script is running, and the run it with the <CODE>sh -x</CODE> flag:
 <P>First we run <CODE>which</CODE>:
<PRE>
carson [9] which pxgraph
/users/ptdesign/bin.sol2.5/pxgraph
</PRE>
The we use <CODE>sh -x</CODE>.  Note that the output you see might be
different, depending on what version of the <CODE>pxgraph</CODE> script
you are running.
<PRE>
carson [10] sh -x /users/ptdesign/bin.sol2.5/pxgraph -help
PTDEFAULT=/users/ptdesign
TYDEFAULT=/users/ptdesign/tycho
JAVADEFAULT=/opt/jdk1.1.6
+ [ -z /users/cxh/ptbuild ]
+ [ -z  ]
+ [ /users/cxh/ptbuild -a -f /users/cxh/ptbuild/tycho/bin/ptarch ]
TYCHO=/users/cxh/ptbuild/tycho
+ export TYCHO
windows=no
+ uname
+ [ SunOS = CYGWIN32/NT ]
+ [ -z  ]
+ [ -d /opt/jdk1.1.6 ]
JAVAHOME=/opt/jdk1.1.6
+ export JAVAHOME
+ [ -z /opt/jdk1.1.6 ]
+ [ ! -r /opt/jdk1.1.6/lib/classes.zip ]
+ [ no = yes ]
+ /opt/jdk1.1.6/bin/java -classpath /users/cxh/ptbuild/tycho/java:/opt/jdk1.1.6/lib/classes.zip ptolemy.plot.Pxgraph -help
Can't find class ptolemy.plot.Pxgraph
carson [11]
</PRE>

In the output below, the key line is the line towards that bottom that
runs the <CODE>java</CODE> interpreter:
<PRE>
+ /opt/jdk1.1.6/bin/java -classpath /users/cxh/ptbuild/tycho/java:/opt/jdk1.1.6/lib/classes.zip ptolemy.plot.Pxgraph -help
</PRE>
In the pxgraph script, the first element in the <CODE>-classpath</CODE>
argument should point lead to the <CODE>ptplot.zip</CODE> file.
In this case, <CODE>/users/cxh/ptbuild/tycho/java/ptolemy/plot/ptplot.zip</CODE>
should exist, but it does not:
<PRE>
carson [12] ls -l /users/cxh/ptbuild/tycho/java/ptolemy/plot/ptplot.zip
/users/cxh/ptbuild/tycho/java/ptolemy/plot/ptplot.zip not found
</PRE>
In this case the problem was that the user did not have Ptplot installed
in the location that the <CODE>pxgraph</CODE> script was guessing.
The fix was to install it.
 <P>Another common fix is to edit the <CODE>pxgraph</CODE> script
and change the variables at the top to point to the proper location.
See the Pxgraph
<A HREF="codeDoc/ptolemy.plot.Pxgraph.html#Installation Instructions">Installation Instructions</A> for details.


 <HR>
<H3>I can't access the Plot class from a java interpreter</H3>
If you try to run the Pxgraph class by passing the Pxgraph classname as a command line argument to the java interpreter, you might see:
<PRE>
ptplot&gt; java Pxgraph
java.lang.NoClassDefFoundError: ptolemy/plot/Plot
        at ptolemy.plot.Pxgraph.&lt;init&gt;(Pxgraph.java)
        at ptolemy.plot.Pxgraph.main(Pxgraph.java)
</PRE>
The problem here is that the Ptplot java classes are in the Ptplot java
package, so you need to set your CLASSPATH to the directory that
contains the ptplot directory, not the directory that contains the
<CODE>Pxgraph.class</CODE> file
So if Pxgraph.class was in the <CODE>/usr/local/java/ptplot</CODE>
directory, you
would set your classpath to <CODE>/usr/local/java</CODE>
 <P>The following two examples show two ways to set your classpath.
<PRE>
cxh@carson 32% setenv CLASSPATH ..:/opt/jdk1.1.6/lib/classes.zip
cxh@carson 33% java ptolemy.plot.Pxgraph -help
Usage: pxgraph [ options ] [=WxH+X+Y] [file ...]
 options that take values as second args:
 -bd &lt;color&gt; (Unsupported)
</PRE>

<PRE>
cxh@carson 34% unsetenv CLASSPATH
cxh@carson 35% java -classpath ..:/opt/jdk1.1.6/lib/classes.zip ptplot.Pxgraph -help
Usage: pxgraph [ options ] [=WxH+X+Y] [file ...]
 options that take values as second args:
 -bd &lt;color&gt; (Unsupported)
</PRE>
Note that you can also set the classpath to include the ptplot.zip
file, rather than including the directory that the <CODE>ptplot</CODE>
directory resides in:
<PRE>
cxh@carson 36% unsetenv CLASSPATH
cxh@carson 57% java -classpath ptplot.zip:/opt/jdk1.1.6/lib/classes.zip ptplot.Pxgraph -help
Usage: pxgraph [ options ] [=WxH+X+Y] [file ...]
 options that take values as second args:
 -bd &lt;color&gt; (Unsupported)

</PRE>


<HR>
<br>
Last updated: $Date$,
comments to: <author>cxh@eecs.berkeley.edu</author>
</body>
</html>
