<!-- $Id$ -->
<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<title>Code Generation</title>
<link href="default.css" rel="stylesheet" type="text/css">
</head>
<body>
<html>
<h1>Code Generation</h1>
This code generator is patterened after the Ptolemy Classic 
code generator where actors have template files consisting
of code blocks.  The code blocks are stitched together to create
the resulting file.

<h2>Simple Ramp Demo</h2>
<ol>
<li>
Open <a href="demo/Ramp/Ramp.xml"><code>$PTII/ptolemy/codegen/Demo/Ramp/Ramp.xml</code></a>
<li> Click on the StaticSchedulingCodeGeneratorIcon.
<li> A dialog box will appear, click on "Generate"
<li> The code will be generated and displayed.
</ol>

<h2>How it works</h2>
This code generator uses reflection to find helper classes that in
turn refer to code blocks.  
<p>For example, if a model contains <code>ptolemy.actor.lib.Ramp</code>,
we look for in <code>$PTII/ptolemy/copernicus/codegen/c/actor/lib/</code>
for <code>Ramp.java</code> and <code>Ramp.c</code>.

<p><code>Ramp.java</code> contains a method:
<pre>
public void generateFireCode(StringBuffer stream)
                throws IllegalActionException {
        CodeStream tmpStream = new CodeStream(this);
        tmpStream.appendCodeBlock("codeBlock1");   

        stream.append(processCode(tmpStream.toString()));
    }
</pre>
The <code>codeBlock1</code> string above refers to the codeblock
in <code>Ramp.c</code>:
<pre>
/***codeBlock1*/
$ref(output) = $ref(init);
$ref(init) += $val(step);
/**/
</pre>

When the code generator runs, it runs <code>generateFireCode()</code>
which reads in <code>codeBlock1</code> and writes it to the output file.

To
</body>
</html>