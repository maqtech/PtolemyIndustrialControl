<?xml version="1.0" standalone="no"?>
<!DOCTYPE entity PUBLIC "-//UC Berkeley//DTD MoML 1//EN"
    "http://ptolemy.eecs.berkeley.edu/xml/dtd/MoML_1.dtd">
<entity name="SmallWorld-ptalon" class="ptolemy.actor.TypedCompositeActor">
    <property name="rectangle" class="ptolemy.vergil.kernel.attributes.RectangleAttribute">
        <property name="_location" class="ptolemy.kernel.util.Location" value="[490.0, 5.0]">
        </property>
        <property name="width" class="ptolemy.data.expr.Parameter" value="352.0">
        </property>
        <property name="height" class="ptolemy.data.expr.Parameter" value="205.0">
        </property>
        <property name="_renderFirst" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
    </property>
    <property name="_createdBy" class="ptolemy.kernel.attributes.VersionAttribute" value="6.1.devel">
    </property>
    <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={3, 25, 1016, 718}, maximized=false}">
    </property>
    <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[800, 600]">
    </property>
    <property name="range" class="ptolemy.data.expr.Parameter" value="55">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="170.0, 20.0">
        </property>
    </property>
    <property name="probability" class="ptolemy.data.expr.Parameter" value="min(1.0, (PI*sureRange^2)/(PI*range^2))">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="170.0, 40.0">
        </property>
    </property>
    <property name="line" class="ptolemy.vergil.kernel.attributes.LineAttribute">
        <property name="_location" class="ptolemy.kernel.util.Location" value="435.0, 100.0">
        </property>
        <property name="x" class="ptolemy.data.expr.Parameter" value="0.0">
        </property>
        <property name="y" class="ptolemy.data.expr.Parameter" value="10.0">
        </property>
    </property>
    <property name="line2" class="ptolemy.vergil.kernel.attributes.LineAttribute">
        <property name="_location" class="ptolemy.kernel.util.Location" value="335.0, 105.0">
        </property>
    </property>
    <property name="annotation" class="ptolemy.kernel.util.Attribute">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure><svg><text x="20" y="20" style="font-size:12; font-family:SansSerif; fill:black">100 meters</text></svg></configure>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text>
      </svg>
    </configure>
        </property>
        <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="335.0, 100.0">
        </property>
    </property>
    <property name="line3" class="ptolemy.vergil.kernel.attributes.LineAttribute">
        <property name="_location" class="ptolemy.kernel.util.Location" value="335.0, 100.0">
        </property>
        <property name="x" class="ptolemy.data.expr.Parameter" value="0.0">
        </property>
        <property name="y" class="ptolemy.data.expr.Parameter" value="10.0">
        </property>
    </property>
    <property name="nodePropagationDelay" class="ptolemy.data.expr.Parameter" value="0.5">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="170.0, 80.0">
        </property>
    </property>
    <property name="annotation2" class="ptolemy.kernel.util.Attribute">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">This demo shows a sensor network where
each node rebroadcasts the first message
it receives.  An "initiator" component
broadcasts a message, and the model keeps
track of the number of nodes that receive
the message after one hop, after two
hops, etc., and plots a histogram.

If you increase the range above the
"sureRange", then the probability of
delivery drops according to the formula
shown, which keeps the expected number
of recipients roughly constant.  It was
shown by Franceschetti et al. (2003)
that on average, fewer hops are
needed when the range increases.

When you run the demo, the initiator
will broadcast a message. A node turns to be
red if it receives the message in one hop;
it turn to be green if it receives it 
more than one hop.  It stays white if
it never receives the message.</text></svg></configure>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text>
      </svg>
    </configure>
        </property>
        <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[475.0, 210.0]">
        </property>
    </property>
    <property name="annotation3" class="ptolemy.kernel.util.Attribute">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:darkgray">Author: Edward Lee, Yang Zhao</text></svg></configure>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text>
      </svg>
    </configure>
        </property>
        <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[385.0, 595.0]">
        </property>
    </property>
    <property name="sureRange" class="ptolemy.data.expr.Parameter" value="55">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="170.0, 60.0">
        </property>
    </property>
    <property name="visualDensity" class="ptolemy.data.expr.Parameter" value="0.25">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="170.0, 100.0">
        </property>
    </property>
    <property name="randomize" class="ptolemy.data.expr.Parameter" value="true">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="170.0, 120.0">
        </property>
    </property>
    <property name="annotation5" class="ptolemy.kernel.util.Attribute">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">Data analysis module.</text></svg></configure>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text>
      </svg>
    </configure>
        </property>
        <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[480.75, 180.0]">
        </property>
    </property>
    <property name="WirelessDirector" class="ptolemy.domains.wireless.kernel.WirelessDirector">
        <property name="_location" class="ptolemy.kernel.util.Location" value="[80.0, 35.0]">
        </property>
    </property>
    <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="0.9530265262152">
    </property>
    <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{441.7154947916667, 316.78662109375}">
    </property>
    <entity name="HistogramPlotter" class="ptolemy.actor.lib.gui.HistogramPlotter">
        <property name="fillOnWrapup" class="ptolemy.data.expr.Parameter" value="false">
        </property>
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={0, 86, 245, 353}}">
        </property>
        <property name="_plotSize" class="ptolemy.actor.gui.SizeAttribute" value="[237, 298]">
        </property>
        <property name="binOffset" class="ptolemy.data.expr.Parameter" value="0.0">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[675.0, 45.0]">
        </property>
        <configure>
<?plotml <!DOCTYPE plot PUBLIC "-//UC Berkeley//DTD PlotML 1//EN"
"http://ptolemy.eecs.berkeley.edu/xml/dtd/PlotML_1.dtd">
<plot>
<title>Histogram</title>
<xLabel>Number of Hops</xLabel>
<yLabel>Number of Nodes</yLabel>
<xRange min="1.0" max="10.5"/>
<yRange min="0.0" max="20.0"/>
<barGraph width="0.5" offset="0.15"/>
<bin width="1.0" offset="0.0"/>
</plot>?>
        </configure>
    </entity>
    <entity name="Average" class="ptolemy.actor.lib.Average">
        <property name="_location" class="ptolemy.kernel.util.Location" value="[650.0, 100.0]">
        </property>
        <port name="input" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_type" class="ptolemy.actor.TypeAttribute" value="double">
            </property>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
        </port>
        <port name="output" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
            <property name="_type" class="ptolemy.actor.TypeAttribute" value="double">
            </property>
        </port>
        <port name="reset" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
        </port>
    </entity>
    <entity name="AverageNumberOfHops" class="ptolemy.actor.lib.MonitorValue">
        <doc>Monitor and display values</doc>
        <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="10">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.UpdatedValueIcon">
            <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
            </property>
            <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="displayWidth">
            </property>
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[750.0, 100.0]">
        </property>
    </entity>
    <entity name="Counter" class="ptolemy.actor.lib.Counter">
        <property name="_location" class="ptolemy.kernel.util.Location" value="[650.0, 160.0]">
        </property>
    </entity>
    <entity name="NumberOfLinks" class="ptolemy.actor.lib.MonitorValue">
        <doc>Monitor and display values</doc>
        <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="10">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.UpdatedValueIcon">
            <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
            </property>
            <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="displayWidth">
            </property>
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[750.0, 160.0]">
        </property>
    </entity>
    <entity name="CompositeActor" class="ptolemy.actor.TypedCompositeActor">
        <property name="_location" class="ptolemy.kernel.util.Location" value="[250.0, 225.0]">
        </property>
        <property name="annotation" class="ptolemy.kernel.util.Attribute">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">This channel has range given by the
"range" parameter and probability of
delivery given by the "probability"
parameter.</text></svg></configure>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text>
      </svg>
    </configure>
            </property>
            <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{105.0, 570.0}">
            </property>
        </property>
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={104, 125, 816, 518}, maximized=false}">
        </property>
        <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[600, 400]">
        </property>
        <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0667694543485">
        </property>
        <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{333.222900390625, 454.09130859375}">
        </property>
        <port name="port" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{580.0, 455.0}">
            </property>
        </port>
        <entity name="Channel" class="ptolemy.domains.wireless.lib.LimitedRangeChannel">
            <property name="defaultProperties" class="ptolemy.data.expr.Parameter" value="{range=range}">
            </property>
            <property name="lossProbability" class="ptolemy.data.expr.Parameter" value="1.0 - probability">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{80.0, 610.0}">
            </property>
        </entity>
        <entity name="RelayNode" class="ptolemy.domains.wireless.demo.SmallWorld.RelayNode">
            <property name="nodePropagationDelay" class="ptolemy.data.expr.Parameter" value="nodePropagationDelay">
            </property>
            <property name="range" class="ptolemy.data.expr.Parameter" value="range">
            </property>
            <property name="haloColor" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.5, 0.5, probability*visualDensity}">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{240.0, 355.0}">
            </property>
            <property name="randomize" class="ptolemy.data.expr.Parameter" value="randomize">
            </property>
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
        </entity>
        <entity name="RelayNode2" class="ptolemy.domains.wireless.demo.SmallWorld.RelayNode">
            <property name="nodePropagationDelay" class="ptolemy.data.expr.Parameter" value="nodePropagationDelay">
            </property>
            <property name="range" class="ptolemy.data.expr.Parameter" value="range">
            </property>
            <property name="haloColor" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.5, 0.5, probability*visualDensity}">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{190.0, 355.0}">
            </property>
            <property name="randomize" class="ptolemy.data.expr.Parameter" value="randomize">
            </property>
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
        </entity>
        <entity name="RelayNode3" class="ptolemy.domains.wireless.demo.SmallWorld.RelayNode">
            <property name="nodePropagationDelay" class="ptolemy.data.expr.Parameter" value="nodePropagationDelay">
            </property>
            <property name="range" class="ptolemy.data.expr.Parameter" value="range">
            </property>
            <property name="haloColor" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.5, 0.5, probability*visualDensity}">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{240.0, 405.0}">
            </property>
            <property name="randomize" class="ptolemy.data.expr.Parameter" value="randomize">
            </property>
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
        </entity>
        <entity name="RelayNode4" class="ptolemy.domains.wireless.demo.SmallWorld.RelayNode">
            <property name="nodePropagationDelay" class="ptolemy.data.expr.Parameter" value="nodePropagationDelay">
            </property>
            <property name="range" class="ptolemy.data.expr.Parameter" value="range">
            </property>
            <property name="haloColor" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.5, 0.5, probability*visualDensity}">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{190.0, 405.0}">
            </property>
            <property name="randomize" class="ptolemy.data.expr.Parameter" value="randomize">
            </property>
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
        </entity>
        <entity name="Initiator" class="ptolemy.actor.ptalon.demo.MultipleNodes.Initiator">
            <property name="_location" class="ptolemy.kernel.util.Location" value="{240.0, 355.0}">
            </property>
        </entity>
        <entity name="WirelessToWired" class="ptolemy.domains.wireless.lib.WirelessToWired">
            <property name="inputChannelName" class="ptolemy.data.expr.StringParameter" value="ReportChannel">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[400.75, 295.0]">
            </property>
        </entity>
        <entity name="ReportChannel" class="ptolemy.domains.wireless.lib.LimitedRangeChannel">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[410.0, 380.0]">
            </property>
        </entity>
        <relation name="relation" class="ptolemy.actor.TypedIORelation">
            <property name="width" class="ptolemy.data.expr.Parameter" value="1">
            </property>
        </relation>
        <link port="port" relation="relation"/>
        <link port="WirelessToWired.payload" relation="relation"/>
    </entity>
    <entity name="SmallWorld" class="ptolemy.actor.ptalon.PtalonActor">
        <property name="_location" class="ptolemy.kernel.util.Location" value="[250.0, 290.0]">
        </property>
        <configure>
            <ptalon file="ptolemy.actor.ptalon.demo.MultipleNodes.SmallWorld">
                <ptalonExpressionParameter name="n" value="3"/>
            </ptalon>
        </configure>
    </entity>
    <relation name="relation2" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[595.0, 45.0]">
        </vertex>
    </relation>
    <relation name="relation" class="ptolemy.actor.TypedIORelation">
    </relation>
    <relation name="relation3" class="ptolemy.actor.TypedIORelation">
    </relation>
    <link port="HistogramPlotter.input" relation="relation2"/>
    <link port="Average.input" relation="relation2"/>
    <link port="Average.output" relation="relation"/>
    <link port="AverageNumberOfHops.input" relation="relation"/>
    <link port="Counter.increment" relation="relation2"/>
    <link port="Counter.output" relation="relation3"/>
    <link port="NumberOfLinks.input" relation="relation3"/>
    <link port="CompositeActor.port" relation="relation2"/>
</entity>
