<!-- $Id$
  @author: Xiaojun Liu and Edward A. Lee
-->
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<link href="../../../../../doc/default.css" rel="stylesheet" type="text/css">
<TITLE>Multimode</TITLE>
</HEAD>
<BODY>

<H1>Multimode Giotto Model</H1>
<p>
This (toy)
example illustrates the use of a finite-state machine (implemented
in the FSM domain) to get a modal Giotto model.  The block diagram
is given below:
<CENTER>
<P><!--"CONVERTED_APPLET"-->
<!-- CONVERTER VERSION 1.0 -->
<OBJECT classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93"
    WIDTH = 600
    HEIGHT = 500
    NAME = "Vergil"
    codebase="http://java.sun.com/products/plugin/1.3/jinstall-13-win32.cab#Version=1,3,0,0">
<PARAM NAME = CODE VALUE = ptolemy.vergil.MoMLViewerApplet>
<PARAM NAME = CODEBASE VALUE = ../../../../..>
<PARAM NAME=ARCHIVE VALUE="
	ptolemy/ptsupport.jar,
	lib/diva.jar,
	ptolemy/vergil/vergilapplet.jar,
	ptolemy/domains/sdf/sdf.jar">
<PARAM NAME = NAME VALUE = "HierarchyVergil" >
<PARAM NAME = "type" VALUE="application/x-java-applet;version=1.3">
<PARAM NAME = "background" VALUE = "#faf0e6">
<PARAM NAME = "modelURL" VALUE = "Multimode.xml">
<PARAM NAME = "includeRunPanel" VALUE="true">
<COMMENT>
<EMBED type="application/x-java-applet;version=1.3"
 code="ptolemy.vergil.MoMLViewerApplet"
 codebase=../../../../..
 archive="
	ptolemy/ptsupport.jar,
	lib/diva.jar,
	ptolemy/vergil/vergilapplet.jar,
	ptolemy/domains/sdf/sdf.jar"
 NAME = "Multimode"
 WIDTH = 600
 HEIGHT = 500
 background="#faf0e6"
 modelURL="Multimode.xml"
 includeRunPanel="true"
 pluginspage="http://java.sun.com/products/plugin/1.3/plugin-install.html">
</COMMENT>
<NOEMBED>
<a href="Multimode.xml">MoML specification for this model.</a>
</NOEMBED>
</EMBED>
</OBJECT>
</CENTER>
This model contains three components, all of which have frequency one.
The middle component is defined by the following FSM:
<CENTER>
<P><!--"CONVERTED_APPLET"-->
<!-- CONVERTER VERSION 1.0 -->
<OBJECT classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93"
    WIDTH = 600
    HEIGHT = 200
    NAME = "Vergil"
    codebase="http://java.sun.com/products/plugin/1.3/jinstall-13-win32.cab#Version=1,3,0,0">
<PARAM NAME = CODE VALUE = ptolemy.vergil.MoMLViewerApplet>
<PARAM NAME = CODEBASE VALUE = ../../../../..>
<PARAM NAME=ARCHIVE VALUE="
	ptolemy/ptsupport.jar,
	lib/diva.jar,
	ptolemy/vergil/vergilapplet.jar,
	ptolemy/domains/sdf/sdf.jar">
<PARAM NAME = NAME VALUE = "HierarchyVergil" >
<PARAM NAME = "type" VALUE="application/x-java-applet;version=1.3">
<PARAM NAME = "background" VALUE = "#faf0e6">
<PARAM NAME = "modelURL" VALUE = "ctrl.xml">
<COMMENT>
<EMBED type="application/x-java-applet;version=1.3"
 code="ptolemy.vergil.MoMLViewerApplet"
 codebase=../../../../..
 archive="
	ptolemy/ptsupport.jar,
	lib/diva.jar,
	ptolemy/vergil/vergilapplet.jar,
	ptolemy/domains/sdf/sdf.jar"
 NAME = "composite"
 WIDTH = 600
 HEIGHT = 200
 background="#faf0e6"
 modelURL="ctrl.xml"
 pluginspage="http://java.sun.com/products/plugin/1.3/plugin-install.html">
</COMMENT>
<NOEMBED>
<a href="ctrl.xml">MoML specification for this model.</a>
</NOEMBED>
</EMBED>
</OBJECT>
</CENTER>
This state machine has two states. The guards on the transitions
cause the transitions to be taken each time the input to the state
machine is a multiple of 4.  The guards read:
<pre>
    (in_S ? in_V : 1) % 4 == 0
</pre>
which is interpreted as follows.  The variable <code>in_S</code>
has value <i>true</i> when the input <i>in</i> is present.
The variable <code>in_V</code> is the value of the input.
Thus, the expression <code>(in_S ? in_V : 1)</code> has value
equal to the input when it is present, and value 1 otherwise.
The percent operator is the usual remainder operator, so the
overall expression will be true when the input is a multiple of 4.
<p>
Each state refines to a separate instance of the following model:
<CENTER>
<P><!--"CONVERTED_APPLET"-->
<!-- CONVERTER VERSION 1.0 -->
<OBJECT classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93"
    WIDTH = 600
    HEIGHT = 200
    NAME = "Vergil"
    codebase="http://java.sun.com/products/plugin/1.3/jinstall-13-win32.cab#Version=1,3,0,0">
<PARAM NAME = CODE VALUE = ptolemy.vergil.MoMLViewerApplet>
<PARAM NAME = CODEBASE VALUE = ../../../../..>
<PARAM NAME=ARCHIVE VALUE="
	ptolemy/ptsupport.jar,
	lib/diva.jar,
	ptolemy/vergil/vergilapplet.jar,
	ptolemy/domains/sdf/sdf.jar">
<PARAM NAME = NAME VALUE = "HierarchyVergil" >
<PARAM NAME = "type" VALUE="application/x-java-applet;version=1.3">
<PARAM NAME = "background" VALUE = "#faf0e6">
<PARAM NAME = "modelURL" VALUE = "one_mode.xml">
<COMMENT>
<EMBED type="application/x-java-applet;version=1.3"
 code="ptolemy.vergil.MoMLViewerApplet"
 codebase=../../../../..
 archive="
	ptolemy/ptsupport.jar,
	lib/diva.jar,
	ptolemy/vergil/vergilapplet.jar,
	ptolemy/domains/sdf/sdf.jar"
 NAME = "composite"
 WIDTH = 600
 HEIGHT = 200
 background="#faf0e6"
 modelURL="one_mode.xml"
 pluginspage="http://java.sun.com/products/plugin/1.3/plugin-install.html">
</COMMENT>
<NOEMBED>
<a href="one_mode.xml">MoML specification for this model.</a>
</NOEMBED>
</EMBED>
</OBJECT>
</CENTER>
In state1, the lower ramp has frequency 2, and therefore increments
at twice the rate of the version in state0.
This is the behavior exhibited by the plot above.
<p>
</BODY>
</HTML>
