<!-- $Id$-->
<html>
<head>
<title>Troubleshooting Ptplot</title>
</head>
<body bgcolor="#faf0e6">
<h1><a name="ptplot troubleshooting ">Troubleshooting Ptplot</a></h1>
<p>
Other sources of information:
<MENU>
<LI> <A HREF="ptplotfaq.htm">Ptplot Frequently Asked Questions (FAQ)</A>
</MENU>

Below is a list of common Ptplot problems.


<H2><A NAME="Problems Starting Ptplot">Problems starting ptplot or
running applets</A></H2>

<H3><A NAME="CLASSPATH">Security violation</A></H3>
 <P>
One known problem is that if you have a
CLASSPATH environment set when you started your browser, you may get
an error message when accessing some of the demos.
We suggest unsetting this environment variable, restarting your
browser (and sending email to Sun's Java team to complain about the
way the CLASSPATH environment variable works).
You may also want to check the
<a href="http://metalab.unc.edu/javafaq/javafaq.html">Java FAQ</a>.
<p>
If you have CLASSPATH set, and you run Netscape, then you might see
messages like:
<PRE>
Applet Marks can't start: security violation: security.class
from local disk trying to access url:
http://ptolemy.eecs.berkeley.edu/java/ptolemy/plot/demo/data.plt
</PRE>
The
CLASSPATH variable is by far and above the trickiest thing to get right.

<H3>Script fails with: Unable to initialize threads: cannot find class</H3>
Below is an example:
<PRE>
ptplot&gt; pxgraph
Unable to initialize threads: cannot find class
java/lang/Thread
</PRE>
The problem here is that the java interpreter is not finding
<CODE>lib/classes.zip</CODE> in the Java Development Kit distribution.
The fix is to set the <CODE>JAVAHOME</CODE> variable
to point to your JDK home directory, and then rerun the script.
<PRE>
cxh@carson 41% setenv JAVAHOME /opt/jdk1.1.6
cxh@carson 42% pxgraph -help
Usage: pxgraph [ options ] [=WxH+X+Y] [file ...]
 options that take values as second args:
</PRE>
<H3>Script fails with: Can't find class ptolemy.plot.<i>classname</i></H3>
Here is an example
<PRE>
carson [3] pxgraph -help
Can't find class ptolemy.plot.compat.PxgraphApplication
carson [4]
</PRE>

The problem here is that the pxgraph script cannot find the ptplot
installation.  This probably means that your PTII environment variable
is not set correctly.  Set it to point to the home directory
of the plot or Ptolemy II distribution.
 <P>
To debug such a situation completely,
use <CODE>which</CODE> (on Unix) or <code>type</code> (on Windows)
to find out which pxgraph
script is running, and the run it with the <CODE>sh -x</CODE> flag:
First we run <CODE>which</CODE>:
<PRE>
carson [9] which pxgraph
/users/ptdesign/bin.sol2.5/pxgraph
</PRE>
The we use <CODE>sh -x</CODE>.  Note that the output you see might be
different, depending on what version of the <CODE>pxgraph</CODE> script
you are running.
<PRE>
carson [10] sh -x /users/ptdesign/bin.sol2.5/pxgraph -help
PTDEFAULT=/users/ptdesign
TYDEFAULT=/users/ptdesign/tycho
JAVADEFAULT=/opt/jdk1.1.6
+ [ -z /users/cxh/ptbuild ]
+ [ -z  ]
+ [ /users/cxh/ptbuild -a -f /users/cxh/ptbuild/tycho/bin/ptarch ]
TYCHO=/users/cxh/ptbuild/tycho
+ export TYCHO
windows=no
+ uname
+ [ SunOS = CYGWIN32/NT ]
+ [ -z  ]
+ [ -d /opt/jdk1.1.6 ]
JAVAHOME=/opt/jdk1.1.6
+ export JAVAHOME
+ [ -z /opt/jdk1.1.6 ]
+ [ ! -r /opt/jdk1.1.6/lib/classes.zip ]
+ [ no = yes ]
+ /opt/jdk1.1.6/bin/java -classpath /users/cxh/ptbuild/tycho/java:/opt/jdk1.1.6/lib/classes.zip ptolemy.plot.Pxgraph -help
Can't find class ptolemy.plot.Pxgraph
carson [11]
</PRE>

In the output below, the key line is the line towards that bottom that
runs the <CODE>java</CODE> interpreter:
<PRE>
+ /opt/jdk1.1.6/bin/java -classpath /users/cxh/ptbuild/tycho/java:/opt/jdk1.1.6/lib/classes.zip ptolemy.plot.Pxgraph -help
</PRE>
In the pxgraph script, the first element in the <CODE>-classpath</CODE>
argument should point lead to the <CODE>ptplot.zip</CODE> file.
In this case, <CODE>/users/cxh/ptbuild/tycho/java/ptolemy/plot/ptplot.zip</CODE>
should exist, but it does not:
<PRE>
carson [12] ls -l /users/cxh/ptbuild/tycho/java/ptolemy/plot/ptplot.zip
/users/cxh/ptbuild/tycho/java/ptolemy/plot/ptplot.zip not found
</PRE>
In this case the problem was that the user did not have Ptplot installed
in the location that the <CODE>pxgraph</CODE> script was guessing.
The fix was to install it.
 <P>Another common fix is to edit the <CODE>pxgraph</CODE> script
and change the variables at the top to point to the proper location.

<p><font size="2" color="#cc0000">Last Updated: $Date$</font>
</body>
</html>
