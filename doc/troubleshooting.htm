<!-- $Id$ -->
<html>
<head>
<title>Troubleshooting</title>
</head>
<body bgcolor="#faf0e6">
<h1>Troubleshooting</h1>
Local Resources
<menu>
<li> <a href="ptIIfaq.htm">Frequently Asked Questions</a>
<li> <a href="help.htm">Getting Help</a>
<li> <a href="coding/applets.htm">Applet Information for Developers</a> -
including links to Applet resources on the net
</menu>

Contents
<menu>

<li> <a href="#build">Troubleshooting Build problems</a>
<li> <a href="#applets">Troubleshooting Applets</a>
	<menu>
	<li> <a href="#jdk">Java version</a>
	<li> <a href="#plugin">The Java Plugin</a>
	<li> <a href="#Diagnosing problems">Diagnosing problems</a>
	<li> <a href="#CLASSPATH">CLASSPATH variable</a>
	<li> <a href="#appletviewer">Appletviewer</a>
	<li> <a href="#Applet Troubleshooting Checklist">Applet Troubleshooting Checklist</a>
	</menu>
</menu>

<H2><a name="build">Troubleshooting Build problems</a></H2>
The <a href="install.htm">Ptolemy II Installation page</a> describes
how to rebuild Ptolemy.  If you are having problems building, try
removing <CODE>$PTII/config.cache</CODE>
and then re-running <CODE>$PTII/configure</CODE> and looking at the contents
of <CODE>$PTII/mk/ptII.mk.in</CODE>.

<dl>
<dt> Under NT, configure fails to run with
<CODE>bash: ./configure: No such file or directory</CODE>
<dd> Make sure that <CODE>/bin/sh.exe</CODE> exists.
See the <a href="install.htm#bin_sh_exe">/bin/sh section of the Installation instructions</a>
</dl>


<H2><a name="applets">Troubleshooting Applets</a></H2>
<p>
In theory, Java programs are "write once, run everywhere." In practice,
Java programs are somewhat less platform dependent than other programs,
but they are still platform dependent. Java programs that run under a web
browser, like Netscape or Internet Explorer, are called <I>applets</I>.
Whether an applet runs correctly depends on the version of the browser,
the operating system, the version of the operating system, and even the
hardware configuration. Collectively, all these parameters are called the
<I>platform</I>.

<P>The Ptolemy II applets have been tested with a very limited number
of platforms. This page is intended to help you diagnose
problems. Please send email to 
<A HREF="mailto:ptII@eecs.berkeley.edu">ptII@eecs.berkeley.edu</A> if you
find errors or can suggest additions to this page.

<H3><A NAME="jdk">Java version</A></H3>
The applets on these pages require JDK 1.2 (JDK stands for the
Java Development Kit). 

<h3><a name="plugin">The Java Plugin</a></h3>
The 
<a href="http://www.javasoft.com/products/plugin/" target="_top">Javasoft Java Plugin</a>
provides support for JDK1.2 under Netscape Communicator 4.5 and Internet
Explorer 4.0.

 <p>Under Windows, the JDK1.2 plugin is automatically installed
when JRE 1.2 is installed (JRE stands for Java Runtime Environment).
JRE 1.2 is available as a standalone install from Sun.  JRE 1.2
is also optionally installed when JDK1.2 is installed.
The JRE does not include the Java compiler (<CODE>javac</CODE>), so
if you are planning on doing any development, you should install
the JDK, not the JRE.  See the
<a href="install.htm">Ptolemy II Installation</a> page for
installation instructions.

 <p>Under Solaris 2.6 and 2.7, the plugin is available as a separate
download (which we have not tested).

 <p>If you are on a platform where the browser does not have
the JDK1.2 plugin, then you can still run the demos with the
JDK <a href="#appletviewer">Appletviewer</a>

<H3><a name="Diagnosing problems">Diagnosing problems</a></H3>

The Java plugin includes a console window which can be enabled by going
to the <CODE>Start</CODE> menu -&gt; <CODE>Program</CODE> -&gt;
 <CODE>Java Plugin Control Panel</CODE>
and selecting <CODE>Show Java Console</CODE>.  Then restart the browser.
 <p>Note that the JDK1.2 Plugin console is different than
the Netscape or IE Java console.

 <p><a name="jit">The</a> plugin control panel also has a checkbox
to turn off the Just In Time (JIT) Compiler.  If you are having problems
with the Netscape process lingering after you exit the browser, then
try turning the JIT off and restarting Navigator.  This is a bug
in the JDK1.2.1 Plug-in, see 
<a href="http://developer.java.sun.com/developer/bugParade/bugs/4236070.html">bug 4236070 in the Java Developer Connection</a>

 <p><a name="jar cache">The</a> plugin control panel also has a checkbox
that turns off the Jar Cache.  If you are debugging applets, you 
may want to turn off the Jar Cache so that .class files and jar files
are reloaded when the applet is reloaded.  Note that if you turn
off the Jar Cache, then memory usage is increased.

<H3><a name="CLASSPATH">CLASSPATH variable</a></H3>
Java supports an environment variable called CLASSPATH that tells the Java
virtual machine where to look for code. As a general rule, it is not a
good idea to set this variable. It is extremely difficult to set it correctly,
and if it is set incorrectly, it may prevent all Java programs from running.
The symptom is usually that you get a "class not found" error, although
this error is generated by Java for almost any kind of problem.

<P>Under Windows NT (4.0), open the Start menu (at the lower left), select
Settings and then Control Panel. Open the System control panel, and click
on the Environment tab. If the CLASSPATH variable is set, we suggest clearing
it (you may want to save its value, since it may be needed by some other
program). You then probably have to restart your browser.

<h3><a name="appletviewer">Appletviewer</a></h3>

If you are having problems running an applet with a browser, and the
applet is on the local machine and you have a JDK installed, you may
want to try using the JDK <CODE>appletviewer</CODE> program instead
of the browser. 
 <p>For example, to view an applet contained in the file
<CODE>myapplet.htm</CODE>
<pre>
setenv CLASSPATH $PTII
appletviewer myapplet.htm
</pre>
 <p>Each Ptolemy II demo has a makefile with a <CODE>demo</CODE>
rule that will run the appletviewer for that demo.  For example,
to run the <CODE>Inspection</CODE> demo:
<pre>
cd $PTII/ptolemy/domains/de/demo/Inspection
make demo
</pre>
The directory above each individual demo also has a <CODE>demo</CODE>
rule that will run all the individual demos
<pre>
cd $PTII/ptolemy/domains/de/demo
make demo
</pre>
To run all the demos:
<pre>
cd $PTII
make demo
</pre>

 <p>The Solaris <CODE>appletviewer</CODE> can also take command line
arguments that are passed to the underlying Java engine.  For example,
to turn on verbose class messages:
<pre>
appletviewer -J-verbose:class myapplet.html
</pre>
 <p>If you see the messages below, then you are running 
a JDK1.1 <CODE>appletviewer</CODE> instead of a JDK 1.2 <CODE>appletviewer</CODE>.
<pre>
Warning: &lt;param&gt; tag outside &lt;applet&gt; ... &lt;/applet&gt;.
Warning: &lt;param&gt; tag outside &lt;applet&gt; ... &lt;/applet&gt;.
Warning: &lt;param&gt; tag outside &lt;applet&gt; ... &lt;/applet&gt;.
Warning: &lt;param&gt; tag outside &lt;applet&gt; ... &lt;/applet&gt;.
Warning: &lt;param&gt; tag outside &lt;applet&gt; ... &lt;/applet&gt;.
Warning: &lt;param&gt; tag outside &lt;applet&gt; ... &lt;/applet&gt;.
Warning: No Applets were started. Make sure the input contains an &lt;applet&gt; tag.
usage: appletviewer [-debug] [-J&lt;javaflag&gt;] [-encoding &lt;character encoding type
 ] url|file ...
</pre>
The solution is to adjust your path so that the JDK1.2 appletviewer
is before the JDK1.1 version.

<h3><a name="Applet Troubleshooting Checklist">Applet Troubleshooting Checklist</a></h3>
If you have problems with applets, follow the checklist below
<ol>

<li> Reload the frame.  Under Netscape Communicator, right click on
the frame, and then select <CODE>Reload Frame</CODE>.

<li> Reload all the frames by hitting the <CODE>Reload</CODE> button.
This is likely to bring you back to the Ptolemy II toplevel page.
 <br>Under Netscape Communicator, holding the Shift key down and hitting
the <CODE>Reload</CODE> button will reload any Java
<CODE>.class</CODE> or <CODE>.jar</CODE> files
 <br>Under Internet Explorer, press Ctrl+F5 or Ctrl+the Refresh button

<li> Restart your browser.

 <li>Verify that the Plugin Control Panel menu choice is present
 <br>Under  <CODE>Start</CODE> -&gt; <CODE>Programs</CODE> -&gt; 
you should have a <CODE>Java Plugin Control Panel</CODE> menu choice
listed in the upper section near the Accessories section.
  <br>If the <CODE>Java Plugin Control Panel</CODE>
 menu choice is not present, then
you may need to install or reinstall the Java plugin.

 <li> Look for an error message in the Java console.
See <a href="#Diagnosing problems">Diagnosing problems</a> above.

 <li> Verify that the browser sees the plugin
 <br>In Netscape, go to help->About plugins, or type in
<a href="about:plugins"><CODE>about:plugins </CODE></a>
into the Location entry widget.
The JDK1.2 plugin should be listed.  If it is not reinstall the plugin.
If the plugin is not listed after reinstalling, then remove and reinstall
Netscape.


<li> Verify that your <CODE>CLASSPATH</CODE> variable is not set.
See the <a href="#CLASSPATH">CLASSPATH variable</a> instructions above.

<li> Verify that you are running a recent version of the browser

<dt> Try out a non-Ptolemy JDK1.2 applet
<dd> If are having problems with the plugin you may want to try
<a href="http://www.javasoft.com/products/plugin/1.2/demos/applets.html">Java Plugin 1.2 Demonstration Applets</a> page has a few sample JDK1.2 applets.

<li> Under Internet Explorer, the Swing Query boxes will sometimes
not respond. The workaround is to minimize the IE window and bring it back.
The query box should now work.

<li> Try opening the applets on the
<a href="http://ptolemy.eecs.berkeley.edu/ptolemyII" target="_top">Ptolemy II Website</a>

<li> Try a different browser

<li> Try running the applets using the JDK
<a name="#appletviewer"><CODE>appletviewer</CODE></a> program.

<li> If you are running under Microsoft Windows or NT, try rebooting.

<li> Use the Plugin Control Panel to turning off the Just In Time
(JIT) compiler in the plugin and restart the browser.
Under NT, the Plugin Control Panel can
be found at <CODE>Start</CODE> -&gt; <CODE>Programs</CODE> -&gt;
<CODE>Java Plugin Control Panel</CODE>

<li> Try running the applets from a different machine or as a different
user.

<li> Uninstall and reinstall browser and the JDK

<br> The most drastic step is to uninstall the browser and JDK.
Unfortunately, this is likely to require that you reinstall any other
plugins, such as Adobe Acrobat.
<ol>
  <li> Uninstall the browser

  <li> Uninstall JDK

  <li> (optional) If deinstallation does not remove the directories where
the browser and the JDK were installed, then remove them by hand.

  <li> Reboot

  <li> Install the browser

  <li> Install JDK

  <li> Try the steps above again.
 </ol>

<li> If you are still having problems,
send email to:
<A HREF="mailto:ptII@eecs.berkeley.edu">ptII@eecs.berkeley.edu</A>
with the following information:
	<menu>
	<li> The URL or file you were trying to run
	<li> Your operating system and version
	<li> The name and version of the browser you were running
	under
	<li> The contents of the Java console
	</menu>

</ol>

<p><font size="2" color="#cc0000">Last Updated: $Date$</font>
</body>
</html>
