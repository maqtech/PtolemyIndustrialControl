<!--$Id$ -->
<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<link href="../default.css" rel="stylesheet" type="text/css">
<title>Setting up a development tree</title>
</head>
<body>
<h1>Setting up a development tree</h1>

This page describes how local developers setup parallel development
trees.  The information below is primarily for use by developers at
U.C. Berkeley.  Remote sites doing Ptolemy II development may want to
emulate the U.C. Berkeley developer setup.

<h2>Parallel trees</h2>
Locally, the master development tree is in <CODE>~ptII</CODE>.
We use the Concurrent Versions System (CVS) to manage the source files.
For more information about CVS, see
<a href="http://www.sourcegear.com/CVS" target="_top"><CODE>http://www.sourcegear.com/CVS</CODE></a>

Locally, the CVS Repository is in <CODE>~cvs/Repository</CODE>.

<h3>Remote users</h3>


Remote users who do not have local accounts should follow these steps:

<ol>

<li> Get an account on our machines
To do this, please send email to root@mho.eecs.berkeley.edu with
the login you would like to use.
The login must be 8 characters or less.  
 <br> The cvs guest accounts run in a restricted shell, the only
programs you can run are <CODE>passwd</CODE> and <CODE>cvs</CODE>.

<li>  Install SSH
Note that you will be using ssh to connect to our machines, so
you will need to install SSH 1.2 as well.
<a href="ftp://ftp.cs.hut.fi/pub/ssh/ssh-1.2.27.tar.gz"><CODE>ftp://ftp.cs.hut.fi/pub/ssh/ssh-1.2.27.tar.gz</CODE></a>
To test ssh, try
<pre>
ssh carson.eecs.berkeley.edu
</pre>


You should see something like:

<pre>
cxh@maury 57% ssh carson.eecs.berkeley.edu
cxh@carson.eecs.berkeley.edu's password:

Last login: Fri Mar 24 09:15:45 2000 from maury.eecs.berke
No mail.
$ 

</pre>
Then use the <CODE>passwd</CODE> command to change your password.

 <p>If your login on our machines is different than the login on the
account you are connecting on, then use:
<pre>
ssh -l <I>remotelogin</I> carson.eecs.berkeley.edu
</pre>

<li>  Install CVS.
See:
<a href="http://www.cyclic.com/cyclic-pages/howget.html"><CODE>http://www.cyclic.com/cyclic-pages/howget.html</CODE></a>

 <p>For information about CVS, see
<a href="http://www.gigascale.org/softdevel/faq/1/"><CODE>http://www.gigascale.org/softdevel/faq/1/</CODE></a>

 <p>You also might want to look over John Reekie's notes at
<a href="http://ptolemy.eecs.berkeley.edu/~johnr/info/cvs.html"><CODE>http://ptolemy.eecs.berkeley.edu/~johnr/info/cvs.html</CODE></a>

You must use ssh to connect to carson.eecs.berkeley.edu (it is also
possible to use kerberos, but it is easier for remote users to use ssh)

 <br>Be sure to set <CODE>CVS_RSH</CODE> to the location of your 
<CODE>ssh</CODE> binary.  


<li> Verify that you are in the <CODE>ptolemy</CODE> Unix group
<pre>
cxh@maury 1% groups
labstaff ptolemy eal sysadmin root majordomo colorpr messer tools
</pre>
If you are not in the <CODE>ptolemy</CODE> Unix group, send email
to <a href="mailto:root@mho.eecs.berkeley.edu">&lt;root@mho.eecs.berkeley.edu&gt;</a>.
(Note that cvs only users on the mho cluster will not be able to run
the groups command)



<li> Remote users can check out the tree with
<pre>
cvs -d :ext:carson.eecs.berkeley.edu:/users/cvs/Repository co ptII
</pre>
</ol>
<h3>Local Users</h3>

Users who have already have an account on the mho cluster can follow
this procedure:

<ol>
<li> Local users should verify that the <CODE>CVSROOT</CODE> environment variable is set to <CODE>~cvs/Repository</CODE>

 <p> The most common location for a Ptolemy II tree is in 
<CODE>~/ptII</CODE>.  To create a copy of the tree in <CODE>~/ptII</CODE>:
<pre>
cd
cvs co ptII
</pre>

<h3>Remote and Local users</h3>

<ol>
<li> Set the <CODE>PTII</CODE> environment variable to the location
of your Ptolemy II tree.  In this case, under C shell:
<pre>
setenv PTII ~/ptII
</pre>


<li> cd to the directory where your Ptolemy II tree is and run
<pre>
cd $PTII
configure
make
</pre>

</ol>


<h2>Browsing your tree from the web</h2>
If you would like to be able to browse your development tree from the
web, then you should set it up so that the development tree is
not publically available to anyone on the net.

<ol>
<li>  Create a directory for your private webpages:
<pre>
mkdir ~/public_html/private
</pre>

An alternative name is <CODE>~/public_html/local</CODE>

<li> Create a link to a <CODE>.htaccess</CODE> file that limits access:
<pre>
cd ~/public_html/private
ln -s /usr/local/apache/htaccess/ohmCluster .htaccess
</pre>

<li>  Create any links you want from that directory.
<pre>
ln -s ~/ptII .
</pre>
</ol>

<h2>Renaming actors</h2>
Below are the steps necessary to rename an actor

<ol>
<li> copy the .java file to the new directory.

<li> Remove the file from the makefile in the old directory
<li> Remove the file from the cvs repository in the old directory
<pre>
cvs delete -f Foo.java
cvs commit -m "Moved Foo to new directory blah" Foo.java makefile
</pre>


<li> Edit the .java file in the new directory and change the package
and the comment at the top if necessary.

<li> Add the new file to the makefile in the new directory

<li> Compile the new file

<li> Add the new file to CVS and commit the change to the makefile

<pre>
cd blah
cvs add Foo.java
cvs commit -m "Moved Foo from oldblah directory" Foo.java makefile
</pre>


<li> Move any tests from the old test directory by doing the
copy - cvs delete - edit - cvs add - commit cycle as above

<li> Run the tests in both the old and new directory

<li> Fix up the Vergil palettes in each directory


<li> Update the glimpse index and then search for
instances of the actor name and fix it:
<pre>
cd $PTII
make glimpse
glimpse -H $PTII Foo
</pre>


<li> Update the framemaker documentation

<li> Check the nightly build the next day for errors
</ol>


<p><font size="2" color="#cc0000">Last Updated: $Date$</font>
</body>
</html>
